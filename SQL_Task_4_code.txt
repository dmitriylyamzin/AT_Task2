SELECT ST_ABONENTS.C_NAME AS ABONENTNAME, CASE QRY_QUEUE.C_ST WHEN '0' THEN 'FAIL' WHEN '1' THEN 'OK' ELSE 'NULL' END AS STATUS, 
    COUNT(*) AS CNT FROM QRY_QUEUE 
    JOIN QRY_TYPE ON QRY_QUEUE.C_QRY_TYPE = QRY_TYPE.ID 
    JOIN ST_ABONENTS ON ST_ABONENTS.ID = QRY_TYPE.C_AB_REF 
    GROUP BY ST_ABONENTS.C_NAME, QRY_QUEUE.C_ST
	ORDER BY ST_ABONENTS.C_NAME, COUNT(*);